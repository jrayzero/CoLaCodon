
zigzag = [(0,0),(0,1),(1,0),(2,0),(1,1),(0,2),(0,3),(1,2),
          (2,1),(3,0),(4,0),(3,1),(2,2),(1,3),(0,4),(0,5),
          (1,4),(2,3),(3,2),(4,1),(5,0),(6,0),(5,1),(4,2),
          (3,3),(2,4),(1,5),(0,6),(0,7),(1,6),(2,5),(3,4),
          (4,3),(5,2),(6,1),(7,0),(7,1),(6,2),(5,3),(4,4),
          (3,5),(2,6),(1,7),(2,7),(3,6),(4,5),(5,4),(6,3),
          (7,2),(7,3),(6,4),(5,5),(4,6),(3,7),(4,7),(5,6),
          (6,5),(7,4),(7,5),(6,6),(5,7),(6,7),(7,6),(7,7)]

MBA_codewords = [
  1,  3,  2,  3,
  2,  3,  2,  7,
  6, 11, 10,  9,
  8,  7,  6, 23,
  22, 21, 20, 19,
  18, 35, 34, 33,
  32, 31, 30, 29,
  28, 27, 26, 25,
  24,
  15, # (MBA stuffing)
  1]  # (start code)

MBA_nbits = [
  1,  3,  3,  4,
  4,  5,  5,  7,
  7,  8,  8,  8,
  8,  8,  8, 10,
  10, 10, 10, 10,
  10, 11, 11, 11,
  11, 11, 11, 11,
  11, 11, 11, 11,
  11,
  11, # (MBA stuffing)
  16]  # (start code)

mtype_nbits = [4, 7, 1, 5, 9, 8, 10, 3, 2, 6]

mvd_codewords_nbits = [
  (  1, 1 ), (  1, 2 ), ( 1, 3 ), (  1,  4 ), (  3,  6 ), (  5,  7 ), (  4,  7 ), (  3,  7 ),
  ( 11, 9 ), ( 10, 9 ), ( 9, 9 ), ( 17, 10 ), ( 16, 10 ), ( 15, 10 ), ( 14, 10 ), ( 13, 10 ), ( 12, 10 )]

CBP_vlc = [( 11, 5 ), (  9, 5 ), ( 13, 6 ), ( 13, 4 ), ( 23, 7 ), ( 19, 7 ), ( 31, 8 ), ( 12, 4 ),
           ( 22, 7 ), ( 18, 7 ), ( 30, 8 ), ( 19, 5 ), ( 27, 8 ), ( 23, 8 ), ( 19, 8 ), ( 11, 4 ),
           ( 21, 7 ), ( 17, 7 ), ( 29, 8 ), ( 17, 5 ), ( 25, 8 ), ( 21, 8 ), ( 17, 8 ), ( 15, 6 ),
           ( 15, 8 ), ( 13, 8 ), (  3, 9 ), ( 15, 5 ), ( 11, 8 ), (  7, 8 ), (  7, 9 ), ( 10, 4 ),
           ( 20, 7 ), ( 16, 7 ), ( 28, 8 ), ( 14, 6 ), ( 14, 8 ), ( 12, 8 ), (  2, 9 ), ( 16, 5 ),
           ( 24, 8 ), ( 20, 8 ), ( 16, 8 ), ( 14, 5 ), ( 10, 8 ), (  6, 8 ), (  6, 9 ), ( 18, 5 ),
           ( 26, 8 ), ( 22, 8 ), ( 18, 8 ), ( 13, 5 ), (  9, 8 ), (  5, 8 ), (  5, 9 ), ( 12, 5 ),
           (  8, 8 ), (  4, 8 ), (  4, 9 ), (  7, 3 ), ( 10, 5 ), (  8, 5 ), ( 12, 6 )]

tcoeff_vlc = {0:{2:(0b0100,4), 3:(0b00101,5), 4:(0b0000110,7), 5:(0b00100110,8), 
                 6:(0b00100001,8), 7:(0b0000001010,10), 8:(0b000000011101,12),
                 9:(0b000000011000,12), 10:(0b000000010011,12), 11:(0b000000010000,12), 12:(0b0000000011010,13), 13:(0b0000000011001,13),
                 14:(0b0000000011000,13), 15:(0b0000000010111,13)},
              1:{1:(0b011,3), 2:(0b000110,6), 3:(0b00100101,8), 4:(0b0000001100,10), 
                 5:(0b000000011011,12), 6:(0b0000000010110,13), 7:(0b0000000010101,13)},
              2:{1:(0b0101,4), 2:(0b0000100,7), 3:(0b00100101,8), 4:(0b0000001100,10), 5:(0b000000011011,12)},
              3:{1:(0b00111,5), 2:(0b00100100,8), 3:(0b000000011100,12), 4:(0b0000000010011,13)},
              4:{1:(0b00110,5), 2:(0b0000001111,10), 3:(0b000000010010,12)},
              5:{1:(0b000111,6), 2:(0b0000001001,10), 3:(0b0000000010010,13)},
              6:{1:(0b000101,6), 2:(0b000000011110,12)},
              7:{1:(0b000100,6), 2:(0b000000010101,12)},
              8:{1:(0b0000111,7), 2:(0b000000010001,12)},
              9:{1:(0b0000101,7), 2:(0b0000000010001,13)},
              10:{1:(0b00100111,8), 2:(0b0000000010000,13)},
              11:{1:(0b00100011,8)},
              12:{1:(0b00100010,8)},
              13:{1:(0b00100000,8)},
              14:{1:(0b0000001110,10)},
              15:{1:(0b0000001101,10)},
              16:{1:(0b0000001000,10)},
              17:{1:(0b000000011111,12)},
              18:{1:(0b000000011010,12)},
              19:{1:(0b000000011001,12)},
              20:{1:(0b000000010111,12)},
              21:{1:(0b000000010110,12)},
              22:{1:(0b0000000011111,13)},
              23:{1:(0b0000000011110,13)},
              24:{1:(0b0000000011101,13)},
              25:{1:(0b0000000011100,13)},
              26:{1:(0b0000000011011,13)}}

mvd_vlc = {-16:(0b00000011001,11), 16:(0b00000011001,11), 
           -15:(0b00000011011,11), 17:(0b00000011011,11), 
           -14:(0b00000011101,11), 18:(0b00000011101,11),
           -13:(0b00000011111,11), 19:(0b00000011111,11),
           -12:(0b00000100001,11), 20:(0b00000100001,11),
           -11:(0b00000100011,11), 21:(0b00000100011,11),
           -10:(0b0000010011,10), 22:(0b0000010011,10),
           -9:(0b0000010101,10), 23:(0b0000010101,10),
           -8:(0b0000010111,10), 24:(0b0000010111,10),
           -7:(0b00000111,8), 25:(0b00000111,8),
           -6:(0b00001001,8), 26:(0b00001001,8),
           -5:(0b00001011,8), 27:(0b00001011,8),
           -4:(0b0000111,7), 28:(0b0000111,7),
           -3:(0b00011,5), 29:(0b00011,5),
           -2:(0b0011,4), 30:(0b0011,4),
           -1:(0b011,3), 0:(0b1,1), 1:(0b010,3),
           2:(0b0010,4), -30:(0b0010,4),
           3:(0b00010,5), -29:(0b00010,5),
           4:(0b0000110,7), -28:(0b0000110,7),
           5:(0b00001010,8), -27:(0b00001010,8),
           6:(0b00001000,8), -26:(0b00001000,8),
           7:(0b00000110,8), -25:(0b00000110,8),
           8:(0b0000010110,10), -24:(0b0000010110,10),
           9:(0b0000010100,10), -23:(0b0000010100,10),
           10:(0b0000010010,10), -22:(0b0000010010,10),
           11:(0b00000100010,11), -21:(0b00000100010,11),
           12:(0b00000100000,11), -20:(0b00000100000,11),
           13:(0b00000011110,11), -19:(0b00000011110,11),
           14:(0b00000011100,11), -18:(0b00000011100,11),
           15:(0b00000011010,11), -17:(0b00000011010,11)}
